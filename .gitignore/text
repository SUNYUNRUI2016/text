<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>pc fullpage</title>
	<style type="text/css">
	*{margin:0;padding:0}
	body{text-align:center;color:#fff;text-align:center}
	.footer,.header{background:#00f;height:30px}
	.doc{height:640px;position:relative;overflow:hidden}
	.main{position:relative}
	.doc .page{position:absolute;height:100%;width:100%;top:100%}
	.doc.done .page{position:static;top:0}
	.page1{background:orange}
	.page2{background:#000}
	.page3{background:red}
	.page4{background:#ddd}
	.page-nav{position: absolute; right: 20px; top: 50%; margin-top: -100px;}
	.page-nav i{display: block; width: 10px; height: 10px; border-radius: 100%; background: #fff; margin: 5px 0;}
	.page-nav .current{background: #000;}
	.doc .nextPage{position: absolute; left: 50%; bottom: 20px; margin-left: -10px;}
	</style>
</head>
<body>
	<div class="header">header</div>
	<div class="doc">
		<div class="main">
			<div class="page page1">page1</div>
			<div class="page page2">page2</div>
			<div class="page page3">page3</div>
			<div class="page page4">page4</div>
		</div>
		<div class="page-nav"><i class="current"></i><i></i><i></i><i></i></div>
		<a href="javascript:void(0)" class="nextPage">下一页</a>
	</div>
	<div class="footer">footer</div>
	<script src="lib-jquery1.10.2.js"></script>
	<script src="jquery-mousewheel.js"></script>
	<script>
		$(function() {
		    var onScroll = false, curIndex = 0, len = $(".doc .page").length;
		    var winHeight = $(window).height();
		    // var boxHeight = winHeight- 60 >640 ? winHeight - 60 : 640; //当需要显示所有内容，需要给外层一个固定高度，保证所有内容都能看到
		    var boxHeight = winHeight - 60;
		    var toPage = function(curIndex) {
		        onScroll = true;
		        var now = -curIndex * boxHeight;
		        $(".page").eq(curIndex).addClass("current").siblings(".page").removeClass("current");
		        $(".page-nav i").eq(curIndex).addClass("current").siblings("i").removeClass("current");
		        $(".main").animate({
		            top:now + "px"
		        }, 1000, function() {
		            onScroll = false;
		        });
		    };
		    $(".doc").css("height", boxHeight);
		    $(".main").css("height", boxHeight * len);
		    $(".page").css("height", boxHeight);
		    $(".doc").addClass("done");
		    var pageNext= function(){
		    	if (curIndex == len - 1) return;
		    	curIndex++;
		    	toPage(curIndex);
		    }
		    var pagePrev = function(){
		    	if (curIndex == 0) return;
		    	curIndex--;
		    	toPage(curIndex);
		    }
		    $(".doc").on("mousewheel", function(e, i) {
		        if (onScroll) return;
		        if (i < -.2) {
		            //向下滚动
		            pageNext();
		        } else {
		            //向上滚动
		            pagePrev();
		        }
		    });
		    $('.nextPage').on('click',function(){
		    	if(onScroll) return;
		    	pageNext();
		    })
		    $('.page-nav i').on('click',function(){
		    	if(onScroll) return;
		    	var index = $(this).index();
		    	toPage(index);
		    })
		});
	</script>
	<script src="base.js"></script>
</body>
</html>
